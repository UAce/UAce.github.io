<!DOCTYPE html> <html lang="en-US"> <head> <title>Webhook vs API: How can you use them? - UAce</title> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale = 1.0, maximum-scale=1.0, user-scalable=no"/> <meta name="apple-mobile-web-app-capable" content="yes"/> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" integrity="sha384-Bfad6CLCknfcloXFOyFnlgtENryhrpZCe29RTifKEixXQZ38WheV+i/6YWSzkz3V" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha384-Q8BgkilbsFGYNNiDqJm69hvDS7NCJWOodvfK/cwTyQD4VQA0qKzuPpvqNER1UC0F" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/styles/zenburn.min.css"> <link rel="stylesheet" href="/assets/css/style.css"> <link rel="shortcut icon" class="favicon" type="image/svg" href="/assets/images/UA_favicon_dark.svg"> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha384-Zm+UU4tdcfAm29vg+MTbfu//q5B/lInMbMCr4T8c9rQFyOv6PlfQYpB5wItcXWe7" crossorigin="anonymous"></script> <script src="https://unpkg.com/sweet-scroll@4.0.0/sweet-scroll.min.js" integrity="sha384-YeNQy+x5Gp48/m1w+zup7sXeNzVPCC14WVR6+jevxGxvRw/1grCNT4QBzGg8b+ov" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js" integrity="sha384-3u0U01MLvyGLlqCxH5vNw55TTJ2zWaZDnxbCYz81kDzq3RYYXMVSDPLxPJu+jcCg" crossorigin="anonymous"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/highlight.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script> <script>hljs.initHighlightingOnLoad();</script> <script>hljs.initLineNumbersOnLoad();</script> <script src="/assets/js/common.js"></script> <script src="/assets/js/check-dark-theme.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-168212953-1"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-168212953-1");</script> <title>Webhook vs API: How can you use them? | UAce</title> <meta name="generator" content="Jekyll v3.8.7"/> <meta property="og:title" content="Webhook vs API: How can you use them?"/> <meta name="author" content="Yu-Yueh Liu"/> <meta property="og:locale" content="en_US"/> <meta name="description" content="Recently, I was asked what was the difference between Webhooks and APIs. This was a question I also had a few years ago when I started programming. In this article, I will briefly explain what they are and give an example of how you can use them. What is an API? API stands for Application Programming Interface. APIs allow applications to talk with each other via a common communication method. There are a lot of different API architectural styles such as REST, SOAP, GraphQL and gRPC. With most APIs, there’s a request followed by a response. For example, a restaurant might have an application that would make an API request to their server and obtain a list of menu items in the response, then display it for their users. A lot applications out there provide public APIs that you can be use in your personal projects such as YouTube Data API and Google Map API. What is a Webhook? Unlike APIs, Webhook is simply an HTTP POST request that is triggered automatically when an event occurs. Basically, webhooks are “user-defined callbacks”. For example, an application could provide a webhook that will get triggered by another application when new data is received (callback) instead of sending requests at fixed interval to fetch new data (polling). Example Using Slack API with Slack Bot Slack provides a complete list of REST API methods available to bots. We are going to use the users.list method to list available users and chat.postMessage method to send a message to a user or channel. 1. Navigate to the Custom Integrations page of your Workspace https://&lt;your-workspace-name&gt;.slack.com/apps/manage/custom-integrations and select Bots 2. Choose a name and add the bot integration. 3. Save the API Token, we will use it later in Slack API requests for authentication. 4. Let’s try out the users.list method using an API client like Postman and click on code to generate code: # slack-api.py import requests, json base_url=&quot;https://slack.com/api&quot; payload={} headers={ &#39;Content-Type&#39;: &#39;application/x-www-form-urlencoded&#39;, &#39;Authorization&#39;: &#39;Bearer [your Slack Bot API Token]&#39; } # Make GET request and receive response response=requests.request(&quot;GET&quot;, f&quot;{base_url}/users.list&quot;, headers=headers, data=payload) # Convert response to a Dict object response_json=json.loads(response.text) # Find user by username username=&#39;yueh.liu&#39; user=next((member for member in response_json[&#39;members&#39;] if member[&#39;name&#39;] == username), None) # Make sure the user exists if not user: raise Exception(f&#39;User [{username}] was not found&#39;) # Save the user_id user_id=user[&#39;id&#39;] 5. Now that we have the User ID, we can try sending a message to that user! We can repeat the previous step with the chat.postMessage method. Make sure to change the request method to POST. You should receive a message like this on Slack The updated code should look something like this: # slack-api.py import requests, json base_url=&quot;https://slack.com/api&quot; payload={} headers={ &#39;Content-Type&#39;: &#39;application/x-www-form-urlencoded&#39;, &#39;Authorization&#39;: &#39;Bearer [your Slack Bot API Token]&#39; } # Make GET request and receive response response=requests.request(&quot;GET&quot;, f&quot;{base_url}/users.list&quot;, headers=headers, data=payload) # Convert response to a Dict object response_json=json.loads(response.text) # Find user by username username=&#39;yueh.liu&#39; user=next((member for member in response_json[&#39;members&#39;] if member[&#39;name&#39;] == username), None) # Make sure the user exists if not user: raise Exception(f&#39;User [{username}] was not found&#39;) # Save the user_id user_id=user[&#39;id&#39;] # Set the parameters such as the channel ID (user ID in our case), username for the bot, text message, icon url, etc # You can also send a JSON payload instead of query parameters, but you would need to change the &#39;Content-Type&#39; to &#39;application/json&#39; in the headers params=f&quot;channel={user_id}&amp;text=Hello Yueh!&amp;username=ua-bot&amp;icon_url=https://some-url-link.jpg&quot; # Make POST request and receive response response=requests.request(&quot;POST&quot;, f&quot;{base_url}/chat.postMessage?{params}&quot;, headers=headers, data=payload) print(response.text) Using Slack Incoming Webhooks Incoming Webhooks are a simple way to post messages from external sources into Slack. They make use of normal HTTP requests with a JSON payload, which includes the message and a few other optional details described later. For this example, we are going to create a Web Server and integrate an Incoming Webhook. We will trigger the webhook automatically to send a message to a user on Slack whenever the server receives a message. 1. Navigate to the Custom Integrations page of your Workspace https://&lt;your-workspace-name&gt;.slack.com/apps/manage/custom-integrations and select Incoming WebHooks 2. Choose a channel (or user) to post your messages and add the webhook You should see a message like this on Slack 3. Save the Webhook url 4. Since webhooks work best as callback from a server, let’s write a simple HTTP server that runs on localhost and port 3000. The web server will receive a message on /message path and read the message content from the payload. # server.py from http.server import BaseHTTPRequestHandler, HTTPServer import json # Define a custom Request Handler class CustomHandler(BaseHTTPRequestHandler): def set_response(self, code, byte_message): self.send_response(code) self.send_header(&quot;Content-type&quot;, &quot;text/plain&quot;) self.end_headers() self.wfile.write(byte_message) def do_GET(self): if self.path == &quot;/&quot;: self.set_response(200, &quot;I&#39;m alive!!!\n&quot;.encode()) self.wfile.write() else: self.send_error(404) return def do_POST(self): if self.path == &quot;/message&quot;: # Get payload content_length=int(self.headers[&quot;Content-Length&quot;]) encoded_data=self.rfile.read(content_length) data=json.loads(encoded_data.decode(&quot;utf-8&quot;)) if not &quot;message&quot; in data and not data[&#39;message&#39;]: self.send_error(400, &quot;Bad Request&quot;, &#39;&quot;message&quot; must be in the payload&#39;) return self.set_response(200, f&quot;Received message: \&quot;{data[&#39;message&#39;]}\&quot;\n&quot;.encode()) else: self.send_error(404) return # Initialize an HTTP server port=3000 address=(&quot;&quot;, port) server=HTTPServer(address, CustomHandler) # Start your server print(f&quot;Starting Web server on localhost:{port}..&quot;) server.serve_forever() 5. Check if server is running Let’s try sending a message 6. Now that the server is running, let’s integrate the webhook into the code! # server.py from http.server import BaseHTTPRequestHandler, HTTPServer import json, requests # Define a custom Request Handler class CustomHandler(BaseHTTPRequestHandler): def set_response(self, code, byte_message): self.send_response(code) self.send_header(&quot;Content-type&quot;, &quot;text/plain&quot;) self.end_headers() self.wfile.write(byte_message) def do_GET(self): if self.path == &quot;/&quot;: self.set_response(200, &quot;I&#39;m alive!!!\n&quot;.encode()) self.wfile.write() else: self.send_error(404) return def do_POST(self): if self.path == &quot;/message&quot;: # Get payload content_length=int(self.headers[&quot;Content-Length&quot;]) encoded_data=self.rfile.read(content_length) data=json.loads(encoded_data.decode(&quot;utf-8&quot;)) if not &quot;message&quot; in data and not data[&#39;message&#39;]: self.send_error(400, &quot;Bad Request&quot;, &#39;&quot;message&quot; must be in the payload&#39;) return self.set_response(200, f&quot;Received message: \&quot;{data[&#39;message&#39;]}\&quot;\n&quot;.encode()) # Trigger the Webhook (make POST request) and we can ignore the response and failure try: webhook_url=&quot;https://hooks.slack.com/services/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&quot; headers={ &#39;Content-Type&#39;: &#39;application/json&#39; } payload=&quot;{ \&quot;text\&quot;: \&quot;Your server received the following message:\n\n&quot; + data[&#39;message&#39;] + &quot;\&quot; }&quot; requests.request(&quot;POST&quot;, webhook_url, headers=headers, data=payload) except Exception: pass else: self.send_error(404) return # Initialize an HTTP server port=3000 address=(&quot;&quot;, port) server=HTTPServer(address, CustomHandler) # Start your server print(f&quot;Starting Web server on localhost:{port}..&quot;) server.serve_forever() 7. Once updated, we can re-send the same message as earlier and you should receive a message like this on Slack: Conclusion An API is a communication method used by applications to talk with other applications. Webhook is a POST request that is triggered automatically when an event happens. References Webhook vs API Comparing API Architectural Styles: SOAP vs REST vs GraphQL vs RPC Slack Incoming Webhooks Slack User Bots 🐢"/> <meta property="og:description" content="Recently, I was asked what was the difference between Webhooks and APIs. This was a question I also had a few years ago when I started programming. In this article, I will briefly explain what they are and give an example of how you can use them. What is an API? API stands for Application Programming Interface. APIs allow applications to talk with each other via a common communication method. There are a lot of different API architectural styles such as REST, SOAP, GraphQL and gRPC. With most APIs, there’s a request followed by a response. For example, a restaurant might have an application that would make an API request to their server and obtain a list of menu items in the response, then display it for their users. A lot applications out there provide public APIs that you can be use in your personal projects such as YouTube Data API and Google Map API. What is a Webhook? Unlike APIs, Webhook is simply an HTTP POST request that is triggered automatically when an event occurs. Basically, webhooks are “user-defined callbacks”. For example, an application could provide a webhook that will get triggered by another application when new data is received (callback) instead of sending requests at fixed interval to fetch new data (polling). Example Using Slack API with Slack Bot Slack provides a complete list of REST API methods available to bots. We are going to use the users.list method to list available users and chat.postMessage method to send a message to a user or channel. 1. Navigate to the Custom Integrations page of your Workspace https://&lt;your-workspace-name&gt;.slack.com/apps/manage/custom-integrations and select Bots 2. Choose a name and add the bot integration. 3. Save the API Token, we will use it later in Slack API requests for authentication. 4. Let’s try out the users.list method using an API client like Postman and click on code to generate code: # slack-api.py import requests, json base_url=&quot;https://slack.com/api&quot; payload={} headers={ &#39;Content-Type&#39;: &#39;application/x-www-form-urlencoded&#39;, &#39;Authorization&#39;: &#39;Bearer [your Slack Bot API Token]&#39; } # Make GET request and receive response response=requests.request(&quot;GET&quot;, f&quot;{base_url}/users.list&quot;, headers=headers, data=payload) # Convert response to a Dict object response_json=json.loads(response.text) # Find user by username username=&#39;yueh.liu&#39; user=next((member for member in response_json[&#39;members&#39;] if member[&#39;name&#39;] == username), None) # Make sure the user exists if not user: raise Exception(f&#39;User [{username}] was not found&#39;) # Save the user_id user_id=user[&#39;id&#39;] 5. Now that we have the User ID, we can try sending a message to that user! We can repeat the previous step with the chat.postMessage method. Make sure to change the request method to POST. You should receive a message like this on Slack The updated code should look something like this: # slack-api.py import requests, json base_url=&quot;https://slack.com/api&quot; payload={} headers={ &#39;Content-Type&#39;: &#39;application/x-www-form-urlencoded&#39;, &#39;Authorization&#39;: &#39;Bearer [your Slack Bot API Token]&#39; } # Make GET request and receive response response=requests.request(&quot;GET&quot;, f&quot;{base_url}/users.list&quot;, headers=headers, data=payload) # Convert response to a Dict object response_json=json.loads(response.text) # Find user by username username=&#39;yueh.liu&#39; user=next((member for member in response_json[&#39;members&#39;] if member[&#39;name&#39;] == username), None) # Make sure the user exists if not user: raise Exception(f&#39;User [{username}] was not found&#39;) # Save the user_id user_id=user[&#39;id&#39;] # Set the parameters such as the channel ID (user ID in our case), username for the bot, text message, icon url, etc # You can also send a JSON payload instead of query parameters, but you would need to change the &#39;Content-Type&#39; to &#39;application/json&#39; in the headers params=f&quot;channel={user_id}&amp;text=Hello Yueh!&amp;username=ua-bot&amp;icon_url=https://some-url-link.jpg&quot; # Make POST request and receive response response=requests.request(&quot;POST&quot;, f&quot;{base_url}/chat.postMessage?{params}&quot;, headers=headers, data=payload) print(response.text) Using Slack Incoming Webhooks Incoming Webhooks are a simple way to post messages from external sources into Slack. They make use of normal HTTP requests with a JSON payload, which includes the message and a few other optional details described later. For this example, we are going to create a Web Server and integrate an Incoming Webhook. We will trigger the webhook automatically to send a message to a user on Slack whenever the server receives a message. 1. Navigate to the Custom Integrations page of your Workspace https://&lt;your-workspace-name&gt;.slack.com/apps/manage/custom-integrations and select Incoming WebHooks 2. Choose a channel (or user) to post your messages and add the webhook You should see a message like this on Slack 3. Save the Webhook url 4. Since webhooks work best as callback from a server, let’s write a simple HTTP server that runs on localhost and port 3000. The web server will receive a message on /message path and read the message content from the payload. # server.py from http.server import BaseHTTPRequestHandler, HTTPServer import json # Define a custom Request Handler class CustomHandler(BaseHTTPRequestHandler): def set_response(self, code, byte_message): self.send_response(code) self.send_header(&quot;Content-type&quot;, &quot;text/plain&quot;) self.end_headers() self.wfile.write(byte_message) def do_GET(self): if self.path == &quot;/&quot;: self.set_response(200, &quot;I&#39;m alive!!!\n&quot;.encode()) self.wfile.write() else: self.send_error(404) return def do_POST(self): if self.path == &quot;/message&quot;: # Get payload content_length=int(self.headers[&quot;Content-Length&quot;]) encoded_data=self.rfile.read(content_length) data=json.loads(encoded_data.decode(&quot;utf-8&quot;)) if not &quot;message&quot; in data and not data[&#39;message&#39;]: self.send_error(400, &quot;Bad Request&quot;, &#39;&quot;message&quot; must be in the payload&#39;) return self.set_response(200, f&quot;Received message: \&quot;{data[&#39;message&#39;]}\&quot;\n&quot;.encode()) else: self.send_error(404) return # Initialize an HTTP server port=3000 address=(&quot;&quot;, port) server=HTTPServer(address, CustomHandler) # Start your server print(f&quot;Starting Web server on localhost:{port}..&quot;) server.serve_forever() 5. Check if server is running Let’s try sending a message 6. Now that the server is running, let’s integrate the webhook into the code! # server.py from http.server import BaseHTTPRequestHandler, HTTPServer import json, requests # Define a custom Request Handler class CustomHandler(BaseHTTPRequestHandler): def set_response(self, code, byte_message): self.send_response(code) self.send_header(&quot;Content-type&quot;, &quot;text/plain&quot;) self.end_headers() self.wfile.write(byte_message) def do_GET(self): if self.path == &quot;/&quot;: self.set_response(200, &quot;I&#39;m alive!!!\n&quot;.encode()) self.wfile.write() else: self.send_error(404) return def do_POST(self): if self.path == &quot;/message&quot;: # Get payload content_length=int(self.headers[&quot;Content-Length&quot;]) encoded_data=self.rfile.read(content_length) data=json.loads(encoded_data.decode(&quot;utf-8&quot;)) if not &quot;message&quot; in data and not data[&#39;message&#39;]: self.send_error(400, &quot;Bad Request&quot;, &#39;&quot;message&quot; must be in the payload&#39;) return self.set_response(200, f&quot;Received message: \&quot;{data[&#39;message&#39;]}\&quot;\n&quot;.encode()) # Trigger the Webhook (make POST request) and we can ignore the response and failure try: webhook_url=&quot;https://hooks.slack.com/services/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&quot; headers={ &#39;Content-Type&#39;: &#39;application/json&#39; } payload=&quot;{ \&quot;text\&quot;: \&quot;Your server received the following message:\n\n&quot; + data[&#39;message&#39;] + &quot;\&quot; }&quot; requests.request(&quot;POST&quot;, webhook_url, headers=headers, data=payload) except Exception: pass else: self.send_error(404) return # Initialize an HTTP server port=3000 address=(&quot;&quot;, port) server=HTTPServer(address, CustomHandler) # Start your server print(f&quot;Starting Web server on localhost:{port}..&quot;) server.serve_forever() 7. Once updated, we can re-send the same message as earlier and you should receive a message like this on Slack: Conclusion An API is a communication method used by applications to talk with other applications. Webhook is a POST request that is triggered automatically when an event happens. References Webhook vs API Comparing API Architectural Styles: SOAP vs REST vs GraphQL vs RPC Slack Incoming Webhooks Slack User Bots 🐢"/> <link rel="canonical" href="https://uace.github.io/2021/02/27/webhooks-vs-api-how-can-you-use-them/"/> <meta property="og:url" content="https://uace.github.io/2021/02/27/webhooks-vs-api-how-can-you-use-them/"/> <meta property="og:site_name" content="UAce"/> <meta property="og:type" content="article"/> <meta property="article:published_time" content="2021-02-27T03:17:00+00:00"/> <meta name="twitter:card" content="summary"/> <meta property="twitter:title" content="Webhook vs API: How can you use them?"/> <script type="application/ld+json">
{"description":"Recently, I was asked what was the difference between Webhooks and APIs. This was a question I also had a few years ago when I started programming. In this article, I will briefly explain what they are and give an example of how you can use them. What is an API? API stands for Application Programming Interface. APIs allow applications to talk with each other via a common communication method. There are a lot of different API architectural styles such as REST, SOAP, GraphQL and gRPC. With most APIs, there’s a request followed by a response. For example, a restaurant might have an application that would make an API request to their server and obtain a list of menu items in the response, then display it for their users. A lot applications out there provide public APIs that you can be use in your personal projects such as YouTube Data API and Google Map API. What is a Webhook? Unlike APIs, Webhook is simply an HTTP POST request that is triggered automatically when an event occurs. Basically, webhooks are “user-defined callbacks”. For example, an application could provide a webhook that will get triggered by another application when new data is received (callback) instead of sending requests at fixed interval to fetch new data (polling). Example Using Slack API with Slack Bot Slack provides a complete list of REST API methods available to bots. We are going to use the users.list method to list available users and chat.postMessage method to send a message to a user or channel. 1. Navigate to the Custom Integrations page of your Workspace https://&lt;your-workspace-name&gt;.slack.com/apps/manage/custom-integrations and select Bots 2. Choose a name and add the bot integration. 3. Save the API Token, we will use it later in Slack API requests for authentication. 4. Let’s try out the users.list method using an API client like Postman and click on code to generate code: # slack-api.py import requests, json base_url = &quot;https://slack.com/api&quot; payload={} headers = { &#39;Content-Type&#39;: &#39;application/x-www-form-urlencoded&#39;, &#39;Authorization&#39;: &#39;Bearer [your Slack Bot API Token]&#39; } # Make GET request and receive response response = requests.request(&quot;GET&quot;, f&quot;{base_url}/users.list&quot;, headers=headers, data=payload) # Convert response to a Dict object response_json = json.loads(response.text) # Find user by username username = &#39;yueh.liu&#39; user = next((member for member in response_json[&#39;members&#39;] if member[&#39;name&#39;] == username), None) # Make sure the user exists if not user: raise Exception(f&#39;User [{username}] was not found&#39;) # Save the user_id user_id = user[&#39;id&#39;] 5. Now that we have the User ID, we can try sending a message to that user! We can repeat the previous step with the chat.postMessage method. Make sure to change the request method to POST. You should receive a message like this on Slack The updated code should look something like this: # slack-api.py import requests, json base_url = &quot;https://slack.com/api&quot; payload={} headers = { &#39;Content-Type&#39;: &#39;application/x-www-form-urlencoded&#39;, &#39;Authorization&#39;: &#39;Bearer [your Slack Bot API Token]&#39; } # Make GET request and receive response response = requests.request(&quot;GET&quot;, f&quot;{base_url}/users.list&quot;, headers=headers, data=payload) # Convert response to a Dict object response_json = json.loads(response.text) # Find user by username username = &#39;yueh.liu&#39; user = next((member for member in response_json[&#39;members&#39;] if member[&#39;name&#39;] == username), None) # Make sure the user exists if not user: raise Exception(f&#39;User [{username}] was not found&#39;) # Save the user_id user_id = user[&#39;id&#39;] # Set the parameters such as the channel ID (user ID in our case), username for the bot, text message, icon url, etc # You can also send a JSON payload instead of query parameters, but you would need to change the &#39;Content-Type&#39; to &#39;application/json&#39; in the headers params = f&quot;channel={user_id}&amp;text=Hello Yueh!&amp;username=ua-bot&amp;icon_url=https://some-url-link.jpg&quot; # Make POST request and receive response response = requests.request(&quot;POST&quot;, f&quot;{base_url}/chat.postMessage?{params}&quot;, headers=headers, data=payload) print(response.text) Using Slack Incoming Webhooks Incoming Webhooks are a simple way to post messages from external sources into Slack. They make use of normal HTTP requests with a JSON payload, which includes the message and a few other optional details described later. For this example, we are going to create a Web Server and integrate an Incoming Webhook. We will trigger the webhook automatically to send a message to a user on Slack whenever the server receives a message. 1. Navigate to the Custom Integrations page of your Workspace https://&lt;your-workspace-name&gt;.slack.com/apps/manage/custom-integrations and select Incoming WebHooks 2. Choose a channel (or user) to post your messages and add the webhook You should see a message like this on Slack 3. Save the Webhook url 4. Since webhooks work best as callback from a server, let’s write a simple HTTP server that runs on localhost and port 3000. The web server will receive a message on /message path and read the message content from the payload. # server.py from http.server import BaseHTTPRequestHandler, HTTPServer import json # Define a custom Request Handler class CustomHandler(BaseHTTPRequestHandler): def set_response(self, code, byte_message): self.send_response(code) self.send_header(&quot;Content-type&quot;, &quot;text/plain&quot;) self.end_headers() self.wfile.write(byte_message) def do_GET(self): if self.path == &quot;/&quot;: self.set_response(200, &quot;I&#39;m alive!!!\\n&quot;.encode()) self.wfile.write() else: self.send_error(404) return def do_POST(self): if self.path == &quot;/message&quot;: # Get payload content_length = int(self.headers[&quot;Content-Length&quot;]) encoded_data = self.rfile.read(content_length) data = json.loads(encoded_data.decode(&quot;utf-8&quot;)) if not &quot;message&quot; in data and not data[&#39;message&#39;]: self.send_error(400, &quot;Bad Request&quot;, &#39;&quot;message&quot; must be in the payload&#39;) return self.set_response(200, f&quot;Received message: \\&quot;{data[&#39;message&#39;]}\\&quot;\\n&quot;.encode()) else: self.send_error(404) return # Initialize an HTTP server port = 3000 address = (&quot;&quot;, port) server = HTTPServer(address, CustomHandler) # Start your server print(f&quot;Starting Web server on localhost:{port}..&quot;) server.serve_forever() 5. Check if server is running Let’s try sending a message 6. Now that the server is running, let’s integrate the webhook into the code! # server.py from http.server import BaseHTTPRequestHandler, HTTPServer import json, requests # Define a custom Request Handler class CustomHandler(BaseHTTPRequestHandler): def set_response(self, code, byte_message): self.send_response(code) self.send_header(&quot;Content-type&quot;, &quot;text/plain&quot;) self.end_headers() self.wfile.write(byte_message) def do_GET(self): if self.path == &quot;/&quot;: self.set_response(200, &quot;I&#39;m alive!!!\\n&quot;.encode()) self.wfile.write() else: self.send_error(404) return def do_POST(self): if self.path == &quot;/message&quot;: # Get payload content_length = int(self.headers[&quot;Content-Length&quot;]) encoded_data = self.rfile.read(content_length) data = json.loads(encoded_data.decode(&quot;utf-8&quot;)) if not &quot;message&quot; in data and not data[&#39;message&#39;]: self.send_error(400, &quot;Bad Request&quot;, &#39;&quot;message&quot; must be in the payload&#39;) return self.set_response(200, f&quot;Received message: \\&quot;{data[&#39;message&#39;]}\\&quot;\\n&quot;.encode()) # Trigger the Webhook (make POST request) and we can ignore the response and failure try: webhook_url = &quot;https://hooks.slack.com/services/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&quot; headers = { &#39;Content-Type&#39;: &#39;application/json&#39; } payload = &quot;{ \\&quot;text\\&quot;: \\&quot;Your server received the following message:\\n\\n&quot; + data[&#39;message&#39;] + &quot;\\&quot; }&quot; requests.request(&quot;POST&quot;, webhook_url, headers=headers, data=payload) except Exception: pass else: self.send_error(404) return # Initialize an HTTP server port = 3000 address = (&quot;&quot;, port) server = HTTPServer(address, CustomHandler) # Start your server print(f&quot;Starting Web server on localhost:{port}..&quot;) server.serve_forever() 7. Once updated, we can re-send the same message as earlier and you should receive a message like this on Slack: Conclusion An API is a communication method used by applications to talk with other applications. Webhook is a POST request that is triggered automatically when an event happens. References Webhook vs API Comparing API Architectural Styles: SOAP vs REST vs GraphQL vs RPC Slack Incoming Webhooks Slack User Bots 🐢","author":{"@type":"Person","name":"Yu-Yueh Liu"},"@type":"BlogPosting","url":"https://uace.github.io/2021/02/27/webhooks-vs-api-how-can-you-use-them/","headline":"Webhook vs API: How can you use them?","dateModified":"2021-02-27T03:17:00+00:00","datePublished":"2021-02-27T03:17:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://uace.github.io/2021/02/27/webhooks-vs-api-how-can-you-use-them/"},"@context":"https://schema.org"}</script> </head> <body> <link rel="icon" id="light-favicon" href="/assets/images/UA_favicon_light.svg" type="image/svg"/> <link rel="icon" id="dark-favicon" href="/assets/images/UA_favicon_dark.svg" type="image/svg"/> <button id="scroll-to-top" title="Scroll to top">Top</button> <nav id="navbar" class="navbar fixed-top navbar-expand-sm justify-content-between"> <div class="container"> <a class="navbar-brand mb-0 h1 add-margin-left-normal add-padding-bottom-small" href="/"> <img src="/assets/images/UA_favicon_dark.svg" width="40" height="30" class="d-inline-block home-logo favicon" alt="UA"> <span class="home-title">UAce</span> </a> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation" onclick="toggleNavbar()"> <span class="navbar-toggler-icon"></span> </button> <div class="collapse navbar-collapse" id="navbarNavAltMarkup"> <div class="navbar-nav nav nav-pills ml-auto text-right"> <a class="nav-item nav-link " id="tab-Articles" href="/articles">Articles</a> <a class="nav-item nav-link " id="tab-Resume" href="/resume">Resume</a> <a class="nav-item nav-link " id="tab-About me" href="/about">About me</a> <a id="theme-icon-wrapper" onclick="modeSwitcher()"><i id="theme-icon" class="icon fas fa-lg"></i></a> </div> </div> </div> </nav> <main class="main-body"> <article class="container post-container"> <header class="post-header"> <h1 class="post-title">Webhook vs API: How can you use them?</h1> <p class="post-meta"> <a href="/about#me"> <img src="/assets/images/yueh.png" width="48" height="48" class="icon-avatar img-fluid img-thumbnail" alt="Me"> </a> <time class="post-datetime" datetime="2021-02-27T03:17:00+00:00">Feb 27, 2021 </time> <span class="bullet-before"> </span><i class="far fa-clock"></i> 10 min to read </p> <span class="post-tags"> <a href="_blank" class="tag" data-proofer-ignore> <span>Webhook</span> </a> <a href="_blank" class="tag" data-proofer-ignore> <span>API</span> </a> <a href="_blank" class="tag" data-proofer-ignore> <span>Slack</span> </a> </span> </header> <div class="post-body"> <p>Recently, I was asked what was the difference between Webhooks and APIs. This was a question I also had a few years ago when I started programming. In this article, I will briefly explain what they are and give an example of how you can use them.</p> <h3 id="what-is-an-api">What is an API?</h3> <p>API stands for Application Programming Interface. APIs allow applications to talk with each other via a common communication method. There are a lot of different API architectural styles such as REST, SOAP, GraphQL and gRPC. With most APIs, there’s a request followed by a response.</p> <p>For example, a restaurant might have an application that would make an API request to their server and obtain a list of menu items in the response, then display it for their users. A lot applications out there provide public APIs that you can be use in your personal projects such as <a href="https://developers.google.com/youtube/v3/getting-started">YouTube Data API</a> and <a href="https://developers.google.com/maps/documentation">Google Map API</a>.</p> <h3 id="what-is-a-webhook">What is a Webhook?</h3> <p>Unlike APIs, Webhook is simply an HTTP POST request that is triggered automatically when an event occurs. Basically, webhooks are <strong>“user-defined callbacks”</strong>.</p> <p>For example, an application could provide a webhook that will get triggered by another application when new data is received (callback) instead of sending requests at fixed interval to fetch new data (polling).</p> <h2 id="example">Example</h2> <h3 id="using-slack-api-with-slack-bot">Using Slack API with Slack Bot</h3> <p>Slack provides a complete list of <a href="https://api.slack.com/bot-users#api_methods_available_to_bots">REST API methods</a> available to bots. We are going to use the <a href="https://api.slack.com/methods/users.list">users.list</a> method to list available users and <a href="https://api.slack.com/methods/chat.postMessage">chat.postMessage</a> method to send a message to a user or channel.</p> <p>1. Navigate to the Custom Integrations page of your Workspace <code class="language-html highlighter-rouge">https://<span class="nt">&lt;your-workspace-name&gt;</span>.slack.com/apps/manage/custom-integrations</code> and select <strong><em>Bots</em></strong> <a href="/assets/posts/webhooks-vs-api-how-can-you-use-them/custom-integrations-bots.png" data-fancybox="gallery" data-caption="Slack Custom Integrations Bots"><img src="/assets/posts/webhooks-vs-api-how-can-you-use-them/custom-integrations-bots.png" alt="Slack Custom Integrations Bots" class="img-fluid img-thumbnail"/></a></p> <p>2. Choose a name and add the bot integration. <a href="/assets/posts/webhooks-vs-api-how-can-you-use-them/add-bot.png" data-fancybox="gallery" data-caption="Add bot"><img src="/assets/posts/webhooks-vs-api-how-can-you-use-them/add-bot.png" alt="Add bot" class="img-fluid img-thumbnail"/></a></p> <p>3. Save the <strong>API Token</strong>, we will use it later in Slack API requests for authentication. <a href="/assets/posts/webhooks-vs-api-how-can-you-use-them/api-token.png" data-fancybox="gallery" data-caption="API token"><img src="/assets/posts/webhooks-vs-api-how-can-you-use-them/api-token.png" alt="API token" class="img-fluid img-thumbnail"/></a></p> <p>4. Let’s try out the <a href="https://api.slack.com/methods/users.list">users.list</a> method using an API client like Postman and click on <strong><em>code</em></strong> to generate code: <a href="/assets/posts/webhooks-vs-api-how-can-you-use-them/list-users.png" data-fancybox="gallery" data-caption="List Users API Request"><img src="/assets/posts/webhooks-vs-api-how-can-you-use-them/list-users.png" alt="List Users" class="img-fluid img-thumbnail"/></a></p> <pre><code class="language-Python"># slack-api.py
import requests, json

base_url = "https://slack.com/api"

payload={}
headers = {
    'Content-Type': 'application/x-www-form-urlencoded',
    'Authorization': 'Bearer [your Slack Bot API Token]'
}

# Make GET request and receive response
response = requests.request("GET", f"{base_url}/users.list", headers=headers, data=payload)

# Convert response to a Dict object
response_json = json.loads(response.text)

# Find user by username
username = 'yueh.liu'
user = next((member for member in response_json['members'] if member['name'] == username), None)

# Make sure the user exists
if not user:
    raise Exception(f'User [{username}] was not found')

# Save the user_id
user_id = user['id']
</code></pre> <p>5. Now that we have the <strong>User ID</strong>, we can try sending a message to that user! We can repeat the previous step with the <a href="https://api.slack.com/methods/chat.postMessage">chat.postMessage</a> method. Make sure to change the request method to <code class="language-html highlighter-rouge">POST</code>. <a href="/assets/posts/webhooks-vs-api-how-can-you-use-them/send-message.png" data-fancybox="gallery" data-caption="Send message to user"><img src="/assets/posts/webhooks-vs-api-how-can-you-use-them/send-message.png" alt="Send message to user" class="img-fluid img-thumbnail"/></a></p> <p>You should receive a message like this on Slack <br/> <a href="/assets/posts/webhooks-vs-api-how-can-you-use-them/ua-bot.png" data-fancybox="gallery" data-caption="Message from ua-bot"><img src="/assets/posts/webhooks-vs-api-how-can-you-use-them/ua-bot.png" alt="ua-bot" class="img-fluid img-thumbnail"/></a></p> <p>The updated code should look something like this:</p> <pre><code class="language-Python"># slack-api.py
import requests, json

base_url = "https://slack.com/api"

payload={}
headers = {
    'Content-Type': 'application/x-www-form-urlencoded',
    'Authorization': 'Bearer [your Slack Bot API Token]'
}

# Make GET request and receive response
response = requests.request("GET", f"{base_url}/users.list", headers=headers, data=payload)

# Convert response to a Dict object
response_json = json.loads(response.text)

# Find user by username
username = 'yueh.liu'
user = next((member for member in response_json['members'] if member['name'] == username), None)

# Make sure the user exists
if not user:
    raise Exception(f'User [{username}] was not found')

# Save the user_id
user_id = user['id']

# Set the parameters such as the channel ID (user ID in our case), username for the bot, text message, icon url, etc
# You can also send a JSON payload instead of query parameters, but you would need to change the 'Content-Type' to 'application/json' in the headers
params = f"channel={user_id}&amp;text=Hello Yueh!&amp;username=ua-bot&amp;icon_url=https://some-url-link.jpg"

# Make POST request and receive response
response = requests.request("POST", f"{base_url}/chat.postMessage?{params}", headers=headers, data=payload)

print(response.text)
</code></pre> <h3 id="using-slack-incoming-webhooks">Using Slack Incoming Webhooks</h3> <blockquote> <p>Incoming Webhooks are a simple way to post messages from external sources into Slack. They make use of normal HTTP requests with a JSON payload, which includes the message and a few other optional details described later.</p> </blockquote> <p>For this example, we are going to create a Web Server and integrate an Incoming Webhook. We will trigger the webhook automatically to send a message to a user on Slack whenever the server receives a message.</p> <p>1. Navigate to the Custom Integrations page of your Workspace <code class="language-html highlighter-rouge">https://<span class="nt">&lt;your-workspace-name&gt;</span>.slack.com/apps/manage/custom-integrations</code> and select <strong><em>Incoming WebHooks</em></strong> <a href="/assets/posts/webhooks-vs-api-how-can-you-use-them/custom-integrations-webhooks.png" data-fancybox="gallery" data-caption="Slack Custom Integrations Incoming Webhooks"><img src="/assets/posts/webhooks-vs-api-how-can-you-use-them/custom-integrations-webhooks.png" alt="Slack Custom Integrations Incoming Webhooks" class="img-fluid img-thumbnail"/></a></p> <p>2. Choose a channel (or user) to post your messages and add the webhook <a href="/assets/posts/webhooks-vs-api-how-can-you-use-them/add-webhook.png" data-fancybox="gallery" data-caption="Add an Incoming Webhook"><img src="/assets/posts/webhooks-vs-api-how-can-you-use-them/add-webhook.png" alt="add-webhook" class="img-fluid img-thumbnail"/></a></p> <p>You should see a message like this on Slack <a href="/assets/posts/webhooks-vs-api-how-can-you-use-them/added-integration.png" data-fancybox="gallery" data-caption="Added Webhook Integration"><img src="/assets/posts/webhooks-vs-api-how-can-you-use-them/added-integration.png" alt="added-integration" class="img-fluid img-thumbnail"/></a></p> <p>3. Save the Webhook url <a href="/assets/posts/webhooks-vs-api-how-can-you-use-them/webhook-url.png" data-fancybox="gallery" data-caption="Slack Webhook url"><img src="/assets/posts/webhooks-vs-api-how-can-you-use-them/webhook-url.png" alt="webhook-url" class="img-fluid img-thumbnail"/></a></p> <p>4. Since webhooks work best as callback from a server, let’s write a simple HTTP server that runs on localhost and port 3000. The web server will receive a message on <code class="language-html highlighter-rouge">/message</code> path and read the message content from the payload.</p> <pre><code class="language-Python"># server.py
from http.server import BaseHTTPRequestHandler, HTTPServer
import json

# Define a custom Request Handler
class CustomHandler(BaseHTTPRequestHandler):
    def set_response(self, code, byte_message):
        self.send_response(code)
        self.send_header("Content-type", "text/plain")
        self.end_headers()
        self.wfile.write(byte_message)

    def do_GET(self):
        if self.path == "/":
            self.set_response(200, "I'm alive!!!\n".encode())
            self.wfile.write()
        else:
            self.send_error(404)
        return

    def do_POST(self):
        if self.path == "/message":
            # Get payload
            content_length = int(self.headers["Content-Length"])
            encoded_data = self.rfile.read(content_length)
            data = json.loads(encoded_data.decode("utf-8"))

            if not "message" in data and not data['message']:
                self.send_error(400, "Bad Request", '"message" must be in the payload')
                return

            self.set_response(200, f"Received message: \"{data['message']}\"\n".encode())
        else:
            self.send_error(404)
        return

# Initialize an HTTP server
port = 3000
address = ("", port)
server = HTTPServer(address, CustomHandler)

# Start your server
print(f"Starting Web server on localhost:{port}..")
server.serve_forever()
</code></pre> <p>5. Check if server is running <br/> <a href="/assets/posts/webhooks-vs-api-how-can-you-use-them/server-get.png" data-fancybox="gallery" data-caption="Check local web server is alive"><img src="/assets/posts/webhooks-vs-api-how-can-you-use-them/server-get.png" alt="server-get" class="img-fluid img-thumbnail"/></a></p> <p>Let’s try sending a message <br/> <a href="/assets/posts/webhooks-vs-api-how-can-you-use-them/server-post.png" data-fancybox="gallery" data-caption="Send message to local web server"><img src="/assets/posts/webhooks-vs-api-how-can-you-use-them/server-post.png" alt="server-post" class="img-fluid img-thumbnail"/></a></p> <p>6. Now that the server is running, let’s integrate the webhook into the code!</p> <pre><code class="language-Python"># server.py
from http.server import BaseHTTPRequestHandler, HTTPServer
import json, requests

# Define a custom Request Handler
class CustomHandler(BaseHTTPRequestHandler):
    def set_response(self, code, byte_message):
        self.send_response(code)
        self.send_header("Content-type", "text/plain")
        self.end_headers()
        self.wfile.write(byte_message)

    def do_GET(self):
        if self.path == "/":
            self.set_response(200, "I'm alive!!!\n".encode())
            self.wfile.write()
        else:
            self.send_error(404)
        return

    def do_POST(self):
        if self.path == "/message":
            # Get payload
            content_length = int(self.headers["Content-Length"])
            encoded_data = self.rfile.read(content_length)
            data = json.loads(encoded_data.decode("utf-8"))

            if not "message" in data and not data['message']:
                self.send_error(400, "Bad Request", '"message" must be in the payload')
                return

            self.set_response(200, f"Received message: \"{data['message']}\"\n".encode())

            # Trigger the Webhook (make POST request) and we can ignore the response and failure
            try:
                webhook_url = "https://hooks.slack.com/services/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"
                headers = { 'Content-Type': 'application/json' }
                payload = "{ \"text\": \"Your server received the following message:\n\n" + data['message'] + "\" }"
                requests.request("POST", webhook_url, headers=headers, data=payload)
            except Exception:
                pass
        else:
            self.send_error(404)
        return

# Initialize an HTTP server
port = 3000
address = ("", port)
server = HTTPServer(address, CustomHandler)

# Start your server
print(f"Starting Web server on localhost:{port}..")
server.serve_forever()
</code></pre> <p>7. Once updated, we can re-send the same message as earlier and you should receive a message like this on Slack: <br/> <a href="/assets/posts/webhooks-vs-api-how-can-you-use-them/ua-webhook.png" data-fancybox="gallery" data-caption="Message from ua-webhook"><img src="/assets/posts/webhooks-vs-api-how-can-you-use-them/ua-webhook.png" alt="ua-webhook" class="img-fluid img-thumbnail"/></a></p> <h2 id="conclusion">Conclusion</h2> <p>An API is a communication method used by applications to talk with other applications. Webhook is a POST request that is triggered automatically when an event happens.</p> <h3 id="references">References</h3> <ul> <li><strong><a href="https://sendgrid.com/blog/webhook-vs-api-whats-difference/">Webhook vs API</a></strong></li> <li><strong><a href="https://www.altexsoft.com/blog/soap-vs-rest-vs-graphql-vs-rpc/">Comparing API Architectural Styles: SOAP vs REST vs GraphQL vs RPC</a></strong></li> <li><strong><a href="https://api.slack.com/messaging/webhooks">Slack Incoming Webhooks</a></strong></li> <li><strong><a href="https://api.slack.com/bot-users">Slack User Bots</a></strong></li> </ul> <script src="//cdn.jsdelivr.net/gh/TRSasasusu/highlightjs-highlight-lines.js@1.1.5/highlightjs-highlight-lines.min.js"></script> <script>hljs.initHighlightingOnLoad(),hljs.initHighlightLinesOnLoad([[],[{start:28,end:35,color:"rgba(255, 255, 255, 0.2)"}],[],[{start:2,end:2,color:"rgba(255, 255, 255, 0.2)"},{start:33,end:40,color:"rgba(255, 255, 255, 0.2)"}]]);</script> <p>🐢</p> </div> </article> </main> <footer> <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js" integrity="sha384-ujbKXb9V3HdK7jcWL6kHL1c+2Lj4MR4Gkjl7UtwpSHg/ClpViddK9TI7yU53frPN" crossorigin="anonymous"></script> <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script> <script src="/assets/js/theme-switcher.js"></script> <div class="row align-items-center"> <span class="col-md-12 text-center"> © 2020 Yu-Yueh Liu ｜ <a href="https://www.youtube.com/watch?v=XvR-kTUad6U" target="_blank">Plus Ultra</a> ｜ <a href="feed.xml" data-proofer-ignore>RSS <i class="fas fa-rss"></i></a> ｜ <a href="sitemap.xml" data-proofer-ignore>Sitemap</a> ｜ <a href='https://ko-fi.com/U7U43SBW4' target='_blank'><img height='30' style='border:0px;height:30px;' src='https://cdn.ko-fi.com/cdn/kofi5.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com'/></a> </span> </div> </footer> </body> </html>